<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil</title>
    <link rel="stylesheet" href="/css/profileStyles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <header class="header">
        <button class="back-btn" onclick="location.href='/main'">⬅️ Atrás</button>
        <a href="/main" class="logo">
            <div>JobMatcher</div>
        </a>
    </header>

    <div id="profile-content" class="profile-container">
        <div class="profile-photo">
            <h2>Foto de Perfil</h2>
            <!-- Se usa la foto del perfil asignada en account.profilePhoto, o se muestra una foto por defecto -->
            <img th:src="${account.profilePhoto} ?: 'https://static.vecteezy.com/system/resources/previews/036/280/651/non_2x/default-avatar-profile-icon-social-media-user-image-gray-avatar-icon-blank-profile-silhouette-illustration-vector.jpg'" 
                 alt="Foto de perfil" id="profilePhoto">
            <!-- Botón para cambiar foto (implementa la actualización en el backend si es necesario) -->
            <button class="btn" onclick="document.getElementById('photoInput').click()">Cambiar Foto</button>
            <input type="file" id="photoInput" accept="image/*" style="display:none;">
        </div>
        <section class="profile-info">
            <h2 th:text="${accountType == 'empresa'} ? 'Perfil de Empresa' : 'Perfil de Usuario'">Información del Perfil</h2>
            <ul>
                <!-- Common fields -->
                <li>
                    <strong>Nombre:</strong> 
                    <span id="name" th:text="${account.name}"></span>
                </li>
                <li>
                    <strong>Email:</strong> 
                    <span id="email" th:text="${account.email}"></span>
                </li>
                <li>
                    <strong>Descripción:</strong> 
                    <span id="description" th:text="${account.description}"></span>
                </li>
                
                <!-- Company-specific fields -->
                <th:block th:if="${isCompany}">

                </th:block>
                
                <!-- User-specific fields -->
                <th:block th:unless="${isCompany}">

                </th:block>
            </ul>
            <div class="button-group">
                <button class="btn" onclick="location.href='/profile/edit'">Editar Perfil</button>
            </div>
        </section>
    </div>

    <!-- Botón para cerrar sesión -->
    <div class="logout-container">
        <button class="logout-btn" onclick="logout()">Cerrar Sesión</button>
    </div>

    <script>
        document.getElementById('photoInput').addEventListener('change', function (e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (evt) {
                    const imgData = evt.target.result;
                    document.getElementById('profilePhoto').src = imgData;
                    // Aquí podrías enviar una petición al backend para actualizar la foto
                };
                reader.readAsDataURL(file);
            }
        });

        function logout() {
            window.location.href = '/logout';
        }
    </script>

    <script th:inline="javascript">
        // Debug information
        console.log('Account data:', {
            name: /*[[${account.name}]]*/ '',
            email: /*[[${account.email}]]*/ '',
            description: /*[[${account.description}]]*/ '',
            accountType: /*[[${accountType}]]*/ ''
        });
    </script>

</body>
</html>