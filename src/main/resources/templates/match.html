<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Match - Empresas</title>
    <link rel="stylesheet" href="/css/matchStyles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="header-left">
            <button class="back-btn" onclick="window.location.href='/main'">‚¨ÖÔ∏è Atr√°s</button>
        </div>
        <div class="title">
            <h1>Match con Empresas</h1>
        </div>
        <div class="header-right"></div>
    </header>

    <div class="companies-grid" id="companies-container">
        <!-- Companies will be loaded here -->
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('/api/companies')
                .then(response => response.json())
                .then(companies => {
                    const container = document.getElementById('companies-container');
                    companies.forEach(company => {
                        const card = createCompanyCard(company);
                        container.appendChild(card);
                    });
                })
                .catch(error => console.error('Error loading companies:', error));
        });

        function createCompanyCard(company) {
            const card = document.createElement('div');
            card.className = 'company-card';
            card.innerHTML = `
                <div class="company-header">
                    <img src="${company.profilePhoto || '/images/default-company.png'}" 
                         alt="${company.name}" 
                         class="company-image">
                    <h2 class="company-name">${company.name}</h2>
                </div>
                <div class="company-info">
                    <p class="company-description">${company.description || 'Sin descripci√≥n'}</p>
                    <div class="company-details">
                        <p><i class="location-icon">üìç</i> ${company.location || 'No especificada'}</p>
                        <p><i class="score-icon">üéØ</i> Match: ${company.questionnaireScore || 0}%</p>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="like-btn" onclick="likeCompany(${company.id})">
                        <span class="button-icon">‚ù§Ô∏è</span> Me interesa
                    </button>
                    <button class="discard-btn" onclick="discardCompany(${company.id})">
                        <span class="button-icon">‚úñÔ∏è</span> Descartar
                    </button>
                </div>
            `;
            return card;
        }

        function likeCompany(id) {
            fetch(`/api/match/like/${id}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('¬°Match realizado con √©xito!', 'success');
                }
            })
            .catch(error => showNotification('Error al realizar match', 'error'));
        }

        function discardCompany(id) {
            fetch(`/api/match/discard/${id}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Empresa descartada', 'info');
                }
            })
            .catch(error => showNotification('Error al descartar', 'error'));
        }

        function showNotification(message, type) {
            // Implementation of notification system
            alert(message);
        }
    </script>
</body>
</html>